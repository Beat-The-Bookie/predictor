<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Predictions 2024-25</title>
  <link rel="icon" type="image/jpg" href="logo.jpg">
  <link rel="stylesheet" href="styles.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
  <script src="https://unpkg.com/@supabase/supabase-js"></script>
  <script src="scripts.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.14.0/Sortable.min.js"></script>
  <script type="text/javascript"
        src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js">
  </script>
  <script type="text/javascript">
    (function(){
        emailjs.init({
          publicKey: "XmiXoggW_rXm35ZzW",
        });
    })();
  </script>
</head>
<body style="padding: 0px;">
  <div class="container" id="login-page">
    <div class="card">
      <div class="card-header bg-primary text-white d-flex align-items-center justify-content-between">
        <img src="logo.jpg" alt="Logo" width="100px", height="100px"/>
        <h1 class="mx-auto mb-0 text-center flex-grow-1 text-white">Login / Register</h1>
        <img src="logo.jpg" alt="Logo" width="100px", height="100px"/>
      </div>
      <div class="card-body">
        <nav class="mb-2">
          <div class="nav nav-tabs" id="login-tabs" role="tablist">
            <button class="nav-link active" id="login-tab" onclick="changeLoginTab('login')">Login</button>
            <button class="nav-link" id="register-tab" onclick="changeLoginTab('register')">Register</button>
          </div>
        </nav>
        <div class="tab-content" id="auth-tabContent">
          <div class="tab-pane fade show active" id="login-form" role="tabpanel" aria-labelledby="login-tab">
            <div class="mb-2 row">
              <label for="email" class="col-sm-4 col-form-label">Email Address</label>
              <div class="col-sm-8">
                <input type="text" id="email" class="form-control">
              </div>
            </div>
            <div class="mb-2 row">
              <label for="pword" class="col-sm-4 col-form-label">Password</label>
              <div class="col-sm-8">
                <div class="input-group">
                  <input type="password" id="pword" class="form-control" />
                  <button class="btn btn-outline-secondary" type="button" onclick="togglePassword('pword', this)">Show</button>
                </div>
              </div>
            </div>
            <div class="mb-2 row">
              <div class="col-sm-4">
                <button class="btn btn-primary" onclick="login()">Login</button>
              </div>
              <div class="col-sm-8">
                <a href="#" class="link-primary" data-bs-toggle="modal" data-bs-target="#resetPasswordModal">Forgot your password?</a>
              </div>
            </div>
          </div>
          <div class="tab-pane fade" id="register-form" role="tabpanel" aria-labelledby="register-tab">
            <div class="mb-2 row">
              <label for="reg-email" class="col-sm-4 col-form-label">Email Address</label>
              <div class="col-sm-8">
                <input type="text" id="reg-email" class="form-control">
              </div>
            </div>

            <div class="mb-2 row">
              <label for="reg-uname" class="col-sm-4 col-form-label">Username</label>
              <div class="col-sm-8">
                <input type="text" id="reg-uname" class="form-control">
              </div>
            </div>

            <div class="mb-2 row">
              <label for="reg-pword" class="col-sm-4 col-form-label">Password</label>
              <div class="col-sm-8">
                <div class="input-group">
                  <input type="password" id="reg-pword" class="form-control">
                  <button class="btn btn-outline-secondary" type="button" onclick="togglePassword('reg-pword', this)">Show</button>
                </div>
              </div>
            </div>

            <div class="mb-2 row">
              <div class="col-sm-4">
                <button type="submit" class="btn btn-primary" onclick="register()" id="reg-btn">Register</button>
              </div>
              <div class="col-sm-8">
                <p class="mb-0">Note: Your username will be visible to other users.</p>
              </div>
            </div>
          </div>
        </div>  
        <div class="modal fade" id="resetPasswordModal" tabindex="-1" aria-labelledby="resetPasswordModalLabel" aria-hidden="true">
          <div class="modal-dialog">
            <div class="modal-content">

              <div class="modal-header">
                <h5 class="modal-title" id="resetPasswordModalLabel">Reset Password</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>

              <div class="modal-body">
                <div class="mb-2">
                  <label for="resetEmail" class="form-label">Enter your email</label>
                  <input type="email" class="form-control" id="resetEmail" placeholder="you@example.com" required>
                </div>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" onclick="sendPasswordReset()">Send Reset Email</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="card mt-3">
      <div class="card-body">
        <section class="intro">
          <h1>Welcome to <strong>Beat the Bookie</strong></h1>
          <p>
            Think you have ball knowledge? Prove it! Predict the final standings for Europe's top leagues — the Premier League, La Liga, Serie A, Bundesliga, Ligue 1, and the Championship.
          </p>
          <p>
            Drag and drop the teams in each league to lock in your predictions. At the end of the season, you'll score points based on how close your predictions were to reality.
          </p>
          <p>
            Compete on the leaderboard, and create custom mini-leagues with friends. You choose how many teams to score per league, and climb the ranks!
          </p>
          <p>
            And the twist? You’re not just playing each other. You’re up against <strong>The Bookie</strong> — our in-house prediction account based on real betting odds. Can you <em>Beat the Bookie</em>?
          </p>
        </section>
      </div>
    </div>
  </div>
  <div class="container d-none" id="main-page-pre">
    <div class="card">
      <div class="card-header bg-primary text-white d-flex align-items-center justify-content-between">
        <img src="logo.jpg" alt="Logo" width="100px", height="100px"/>
        <h1 class="mx-auto mb-0 text-center flex-grow-1 text-white">Beat The Bookie 2025/26</h1>
        <img src="logo.jpg" alt="Logo" width="100px", height="100px"/>
      </div>
      <div class="card-body">
        <nav class="d-flex align-items-center">
          <div class="nav nav-tabs" id="pre-nav-tab" role="tablist">
            <button class="nav-link active" id="pre-nav-home-tab" type="button" role="tab" onclick="change_tab('pre-nav-home')">Welcome</button>
            <button class="nav-link" id="pre-nav-prem-tab" type="button" role="tab" onclick="change_tab('pre-nav-prem')">Premier League</button>
            <button class="nav-link" id="pre-nav-la_liga-tab" type="button" role="tab" onclick="change_tab('pre-nav-la_liga')">La Liga</button>
            <button class="nav-link" id="pre-nav-champ-tab" type="button" role="tab" onclick="change_tab('pre-nav-champ')">Championship</button>
            <button class="nav-link" id="pre-nav-seriea-tab" type="button" role="tab" onclick="change_tab('pre-nav-seriea')">Serie A</button>
            <button class="nav-link" id="pre-nav-bundes-tab" type="button" role="tab" onclick="change_tab('pre-nav-bundes')">Bundesliga</button>
            <button class="nav-link" id="pre-nav-ligue1-tab" type="button" role="tab" onclick="change_tab('pre-nav-ligue1')">Ligue 1</button>
            <button class="nav-link" id="pre-nav-leaderboard-tab"  type="button" role="tab" onclick="change_tab('pre-nav-leaderboard')">Leaderboard</button>
            <button class="nav-link" id="pre-nav-leagues-tab" type="button" role="tab" onclick="change_tab('pre-nav-leagues')">Leagues</button>
          </div>
          <button class="btn btn-danger ms-auto" onclick="logout()">Logout</button>
        </nav>
        <div class="tab-content" id="nav-tabContent">
          <div class="tab-pane show active" id="pre-nav-home" role="tabpanel" tabindex="0">
            <section class="welcome">
              <h1>Welcome to <strong>Beat the Bookie</strong>!</h1>

              <p>
                Think you’ve got ball knowledge? Now’s your chance to prove it. Rank every team in Europe’s top leagues — the Premier League, La Liga, Serie A, Bundesliga, Ligue 1, and the Championship — in the order you think they’ll finish this season.
              </p>

              <p>
                Drag and drop teams within each league tab to lock in your predictions. The closer your picks are to the real final standings, the more points you score!
              </p>

              <p>
                Compete on the global leaderboard — where all 20 Premier League teams are scored, and only the top 6 from each other league count.
              </p>

              <p>
                You can also create custom mini-leagues with friends, where you decide how many teams count toward the score in each league.
              </p>

              <p>
                And remember — you’re not just playing each other. You’re up against <strong>The Bookie</strong>: our official prediction account based on real betting odds. Can you <em>Beat the Bookie</em>?
              </p>

              <p>
                <strong>Deadline:</strong> 8th August 2025 at 18:00. After this point, predictions will be locked. You’ll still be able to log in, view your score and others’, and see everyone’s predictions.
              </p>

              <h1>Prizes</h1>
              <p>
                Finish top of the main leaderboard and win a <strong>£10 Amazon voucher</strong>. If you referred the winner, you’ll get <strong>£10 too</strong>!
              </p>

              <h1>Your Referral Link</h1>
              <p>
                Share your unique referral link below — if a friend joins through your link and goes on to win, you both win!
              </p>

              <div id="referral-section" class="referral-container mt-3">
                <label for="referral-link" class="referral-label">Your referral link:</label>
                <input id="referral-link" type="text" readonly>
                <button onclick="copyReferral()">Copy</button>
              </div>
            </section>

          </div>
          <div class="tab-pane" id="pre-nav-prem" role="tabpanel" tabindex="0">
            <div class="row justify-content-around">
              <div class="col-md-6" id="prem-table"></div>
              <div class="col-md-5 list-group" id="prem-pred-table"></div>
              <button class="btn btn-primary" onclick="save_changes('prem')">Save Changes</button>
              <button class="btn btn-danger" onclick="reset_changes('prem')">Cancel Changes</button>
            </div>
          </div>
          <div class="tab-pane" id="pre-nav-la_liga" role="tabpanel" tabindex="0">
            <div class="row justify-content-around">
              <div class="col-md-6" id="la_liga-table"></div>
              <div class="col-md-5 list-group" id="la_liga-pred-table"></div>
              <button class="btn btn-primary" onclick="save_changes('la_liga')">Save Changes</button>
              <button class="btn btn-danger" onclick="reset_changes('la_liga')">Cancel Changes</button>
            </div>
          </div>
          <div class="tab-pane" id="pre-nav-champ" role="tabpanel" tabindex="0">
            <div class="row justify-content-around">
              <div class="col-md-6" id="champ-table"></div>
              <div class="col-md-5 list-group" id="champ-pred-table"></div>
              <button class="btn btn-primary" onclick="save_changes('champ')">Save Changes</button>
              <button class="btn btn-danger" onclick="reset_changes('champ')">Cancel Changes</button>
            </div>
          </div>
          <div class="tab-pane" id="pre-nav-seriea" role="tabpanel" tabindex="0">
            <div class="row justify-content-around">
              <div class="col-md-6" id="seriea-table"></div>
              <div class="col-md-5 list-group" id="seriea-pred-table"></div>
              <button class="btn btn-primary" onclick="save_changes('seriea')">Save Changes</button>
              <button class="btn btn-danger" onclick="reset_changes('seriea')">Cancel Changes</button>
            </div>
          </div>
          <div class="tab-pane" id="pre-nav-bundes" role="tabpanel" tabindex="0">
            <div class="row justify-content-around">
              <div class="col-md-6" id="bundes-table"></div>
              <div class="col-md-5 list-group" id="bundes-pred-table"></div>
              <button class="btn btn-primary" onclick="save_changes('bundes')">Save Changes</button>
              <button class="btn btn-danger" onclick="reset_changes('bundes')">Cancel Changes</button>
            </div>
          </div>
          <div class="tab-pane" id="pre-nav-ligue1" role="tabpanel" tabindex="0">
            <div class="row justify-content-around">
              <div class="col-md-6" id="ligue1-table"></div>
              <div class="col-md-5 list-group" id="ligue1-pred-table"></div>
              <button class="btn btn-primary" onclick="save_changes('ligue1')">Save Changes</button>
              <button class="btn btn-danger" onclick="reset_changes('ligue1')">Cancel Changes</button>
            </div>
          </div>
          <div class="tab-pane" id="pre-nav-leaderboard" role="tabpanel" tabindex="0">
            <div class="row justify-content-around">
              <div class="col-12" id="pre-leaderboard"></div>
            </div>
          </div>
          <div class="tab-pane" id="pre-nav-leagues" role="tabpanel" tabindex="0">
            <div class="row justify-content-around">
              <div class="col-12" id="pre-leagues"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="container d-none" id="main-page-post">
    <div class="card">
      <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
        <div>
          Predictions 2024/2025 - <span id="viewing"></span>
        </div>
        <button id="homeBtn" class="btn btn-light btn-sm d-none" onclick="add_locked_preds()">
          <i class="bi bi-house"></i>
        </button>
      </div>
            <div class="card-body">
        <nav class="d-flex align-items-center">
          <div class="nav nav-tabs" id="post-nav-tab" role="tablist">
            <button class="nav-link active" id="post-nav-home-tab" type="button" role="tab" onclick="change_tab('post-nav-home')">Home</button>
            <button class="nav-link" id="post-nav-prem-tab" type="button" role="tab" onclick="change_tab('post-nav-prem')">Premier League</button>
            <button class="nav-link" id="post-nav-la_liga-tab" type="button" role="tab" onclick="change_tab('post-nav-la_liga')">La Liga</button>
            <button class="nav-link" id="post-nav-champ-tab" type="button" role="tab" onclick="change_tab('post-nav-champ')">Championship</button>
            <button class="nav-link" id="post-nav-seriea-tab" type="button" role="tab" onclick="change_tab('post-nav-seriea')">Serie A</button>
            <button class="nav-link" id="post-nav-bundes-tab" type="button" role="tab" onclick="change_tab('post-nav-bundes')">Bundesliga</button>
            <button class="nav-link" id="post-nav-ligue1-tab" type="button" role="tab" onclick="change_tab('post-nav-ligue1')">Ligue 1</button>
            <button class="nav-link" id="post-nav-leaderboard-tab"  type="button" role="tab" onclick="change_tab('post-nav-leaderboard')">Leaderboard</button>
            <button class="nav-link" id="post-nav-leagues-tab" type="button" role="tab" onclick="change_tab('post-nav-leagues')">Leagues</button>
          </div>
          <button class="btn btn-danger ms-auto" onclick="logout()">Logout</button>
        </nav>
        <div class="tab-content" id="nav-tabContent">
          <div class="tab-pane show active" id="post-nav-home" role="tabpanel" tabindex="0">
            <h3>Welcome to Predictions 2024/2025!</h3>
            <h6>Your current scores!</h6>
            <div id="current-scores"></div>
            <h6>We are now in the post-deadline state, so please take a look! These are the things that have been added:</h6>
            <ul>
              <li>The main leaderboard now takes into account all 20 prem teams, and 6 teams in all other leagues. Previously, it considered all teams in all leagues.</li>
              <li>The leaderboard is sortable by league, or total. Before, it wasn't sorted at all.</li>
              <li>You can now view others' predictions. You can do this by clicking on another user in the leaderboard, or in mini-leagues.</li>
              <li>The current score box above, which will be tidied at some point.</li>
            </ul>
            <h6>Future changes to be made:</h6>
            <ul>
              <li>Currently, you can compare yours', and the other user's predictions. I will change this so that you can also see the standings in future.</li>
              <li>The mini-leagues will be able to be sorted by league. This is not possible until next season as it requires a big database change.</li>
              <li>Presets for mini-league limits.</li>
              <li>The ability for the admin to change the mini-league limits after creation, but before the deadline.</li>
            </ul>
            <p>For any queries, issues, or suggestions, please do not hesitate to email at <a href="mailto:footpredinfo@gmail.com">footpredinfo@gmail.com</a></p>
            <p>Stay tuned! There will be future updates, and more feedback requests!</p>
            <p>All things going well, there should be a proper release in June 2025.</p>
            <p>Please feel free to mention this project to other people. While they can't sign up now, a little bit of excitement would be good for the new season.</p>
          </div>
          <div class="tab-pane" id="post-nav-prem" role="tabpanel" tabindex="0">
            <div class="row justify-content-around">
              <div class="col-md-6" id="prem-pred-locked"></div>
              <div class="col-md-6" id="prem-standings"></div>
            </div>
          </div>
          <div class="tab-pane" id="post-nav-la_liga" role="tabpanel" tabindex="0">
            <div class="row justify-content-around">
              <div class="col-md-6" id="la_liga-pred-locked"></div>
              <div class="col-md-6" id="la_liga-standings"></div>
            </div>
          </div>
          <div class="tab-pane" id="post-nav-champ" role="tabpanel" tabindex="0">
            <div class="row justify-content-around">
          <div class="col-md-6" id="champ-pred-locked"></div>
          <div class="col-md-6" id="champ-standings"></div>
        </div>
      </div>
      <div class="tab-pane" id="post-nav-seriea" role="tabpanel" tabindex="0">
        <div class="row justify-content-around">
          <div class="col-md-6" id="seriea-pred-locked"></div>
          <div class="col-md-6" id="seriea-standings"></div>
        </div>
      </div>
      <div class="tab-pane" id="post-nav-bundes" role="tabpanel" tabindex="0">
        <div class="row justify-content-around">
          <div class="col-md-6" id="bundes-pred-locked"></div>
          <div class="col-md-6" id="bundes-standings"></div>
        </div>
      </div>
      <div class="tab-pane" id="post-nav-ligue1" role="tabpanel" tabindex="0">
        <div class="row justify-content-around">
          <div class="col-md-6" id="ligue1-pred-locked"></div>
          <div class="col-md-6" id="ligue1-standings"></div>
        </div>
      </div>
      <div class="tab-pane" id="post-nav-leaderboard" role="tabpanel" tabindex="0">
        <div class="row justify-content-around">
          <div class="col-12" id="post-leaderboard"></div>
        </div>
      </div>
      <div class="tab-pane" id="post-nav-leagues" role="tabpanel" tabindex="0">
        <div class="row justify-content-around">
          <div class="col-12" id="post-leagues"></div>
        </div>
      </div>
    </div>
  </div>
</body>
</html>